
<% alw_oth = Array.new() %>
<% details['list'].each do |endpoint| %>
	<% if endpoint.has_key?('allowed_dom') then %>
		<% alw_oth.push "#{endpoint['url']} allows access from: #{endpoint['allowed_dom']}" %>
	<% end %>
<end>

<% if alw_oth.size >1 %>
	<% name "Cross-Origin Resource Sharing [#{alw_all.size} urls]" %>
<% else %>
	<% name "Cross-Origin Resource Sharing [1 url]" %>
<% end %>

<% priority 10 %>


<b>Description:</b> Some URLs of this server allow access from other origins, which makes it easier for remote attackers to conduct cross-site request forgery (CSRF) attacks.<br/>
<b>Affected URLs:</b> <br/>


			<% alw_oth.each do |ao| %>
			<%= "#{ao}<br/>" %>
			<% end %>

<b>Advice: </b> Check all affected URLs, and deny unexpected origins.<br/>
<b>References:</b><br/>
W3C - http://www.w3.org/TR/cors/<br/>
